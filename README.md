# TerraBazar :convenience_store:

Глобальный базар всего - от быта до экзотики. Ваш мир покупок - здесь!

___

## Профиль проекта

Проект представляет собой интернет-магазин, реализует базовую функциональность электронной
коммерции с возможностями для пользователей и администраторов.

### Цель проекта

Демонстрация навыков работы с ORM-системами, обработки серверных запросов,
обеспечения безопасности данных (аутентификация, авторизация),
а также создания полноценного backend-функционала для интернет-магазина
с интеграцией БД и тестированием.

### Ключевые функции

#### Для покупателей:

+ Регистрация/авторизация пользователя
+ Просмотр каталога товаров
+ Управление корзиной (добавление/удаление/изменения количества товаров)
+ Оформление заказа с указанием адреса доставки
+ Применение промокодов
+ Просмотр истории заказов

#### Для администраторов:

+ Управление товарами
+ Управление категориями товаров
+ Создание/редактирование промокодов
+ Просмотр статистики продаж
+ Контроль остатков товаров

### Целевая аудитория

#### Покупатели

+ Совершающие интернет-покупки
+ Ценящие удобство работы с корзиной и промокодами

#### Администраторы магазина

+ Управление товарами, категориями, заказами
+ Настройка скидов через промокоды

#### Маркетологи

+ Анализ эффективности промокодов
+ Формирование стратегий продвижения товара

### Технологический стек

|  Категория  	  |     Технология        	     |
|:--------------:|:---------------------------:|
|  Backend   	   |    Python, Flask       	    |
| Базы данных 	  |   SQLAlchemy(ORM)      	    |
|  Frontend   	  | HTML, CSS, Jinja2-шаблоны 	 |
| Безопасность 	 |  Сессии, валидация форм  	  |

## Структура проекта

```commandline
Final_Yandex_Proj/
├── data/                    # Работа с базой данных
│   ├── db_session.py        # Модуль для получения сессий БД (get_db)
│   └── __all_models.py      # Все модели SQLAlchemy:
│       • User
│       • Product
│       • Category
│       • Cart/CartItem
│       • Order/OrderItem
│       • DeliveryAddress
│       • PromoCode
│
├── static/                  # Статические файлы
│   └── img/                 
│       └── products/        # Изображения товаров (UPLOAD_FOLDER)
│
├── templates/               # HTML-шаблоны
│   ├── admin/               # Админ-панель
│   │   ├── promo_list.html  # Список промокодов
│   │   └── promo_form.html  # Форма промокода
│   │
│   │
│   │
│   ├── access_denied.html   # Недостаточно прав для доступа на страницу
│   ├── admin.html           # Панель для администратора
│   ├── auth.html            # Страница авторизации
│   ├── base.html            # Базовая страница всех файлов, от которой идет наследование
│   ├── cart.html            # Корзина
│   ├── confirm_order.html   # Страница подтверждения заказа
│   ├── delivery.html        # Оформление заказа
│   ├── edit_product         # Страница редактирования товара в панели администратора
│   ├── lk.html              # Личный кабинет пользователя
│   ├── main.html            # Главная страница магазина
│   ├── orders.html          # История заказов
│   ├── product_cart.html    # Карточка товара в катологе
│   ├── registration.html    # Страница регистрации нового пользователя
│   └── payment.html         # Страница оплаты
│
├── app.py                   # Основной файл приложения (все роуты)
├── requirements.txt         # Зависимости (Flask, SQLAlchemy, pytz и т.д.)
└── README.md                # Документация
```

## Установка и настройка

### 1. Требования к окружению

+ **Python 3.8**
+ **Pip**

### 2. Клонирование

```commandline
git clone https://github.com/boomchik93/TerraBazar.git
cd Final_Yandex_Proj
```

### 3. Установка зависимостей

```commandline
pip install -r requirements.txt
```

### 4. Инициализация БД(SQLite)

+ База данных shop.db создается автоматически при первом запуске.

### 5. Запуск

```commandline
flask run --host=0.0.0.0 --port=5000
```

Приложение доступно: http://localhost:5000.

## Безопасность

### Аутентификация и авторизация:

+ Сессии Flask с использованием секретного ключа (app.secret_key).
+ Валидация прав через is_admin() перед выполнением административных действий.

### Защита данных:

+ SQL-инъекции: Использование ORM (SQLAlchemy) автоматически экранирует запросы.

+ Телефонные номера: Валидация формата через регулярные выражения (^\+7\d{10}$).

### Промокоды:

+ Проверка срока действия (end_date).

+ Ограничение на количество активаций (max_activations).

+ Запрет повторного использования (is_reusable).

### Корзина и заказы:

+ Проверка остатков товаров перед оформлением заказа.

+ Автоматическое обновление stock_quantity после покупки.
